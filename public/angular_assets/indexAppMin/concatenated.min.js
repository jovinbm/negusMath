angular.module("app",["ui.bootstrap","cfp.loadingBar","angulartics","angulartics.google.analytics","angularMoment","ui.router","duScroll","ngFx","textAngular","angularUtils.directives.dirDisqus","ngTagsInput","ui.utils","ngFileUpload","toastr"]),angular.module("app").directive("accountOuterScope",["$rootScope",function(t){return{restrict:"AE",link:function(t,e,n){t.userLoginState="signIn",t.changeUserLoginState=function(e){t.userLoginState=e}}}}]),angular.module("app").directive("newPostBanner",["$rootScope",function(t){return{templateUrl:"views/all/partials/templates/new_post_banner.html",restrict:"AE",link:function(e,n,o){e.newPostBanner={show:!1,bannerClass:"",msg:""},t.$on("newPostBanner",function(t,n){e.newPostBanner=n}),t.$on("clearBanners",function(){e.newPostBanner={show:!1,bannerClass:"",msg:""}})}}}]).directive("toastrDirective",["$rootScope","toastr",function(t,e){return{restrict:"AE",link:function(n,o,r){t.showToast=function(t,n){switch(t){case"success":e.clear(),e.success(n);break;case"warning":e.clear(),e.warning(n,"Warning",{closeButton:!0,tapToDismiss:!0});break;case"error":e.clear(),e.error(n,"Error",{closeButton:!0,tapToDismiss:!0,timeOut:!1});break;default:e.clear()}},t.clearToasts=function(){e.clear()}}}}]).directive("loadingBanner",["$rootScope",function(t){var e=["$scope","$rootScope","cfpLoadingBar",function(t,e,n){e.isLoading=!0,e.isLoadingPercentage=0,e.changeIsLoadingPercentage=function(t){e.isLoadingPercentage=t},e.$on("cfpLoadingBar:loading",function(t,o){e.isLoadingPercentage=100*n.status()}),e.$on("cfpLoadingBar:loaded",function(t,o){e.isLoadingPercentage=100*n.status()}),e.$on("cfpLoadingBar:completed",function(t,o){e.isLoadingPercentage=100*n.status()}),e.isLoadingTrue=function(){e.isLoading=!0},e.isLoadingFalse=function(){e.isLoading=!1},e.$on("isLoadingTrue",function(){e.isLoading=!0}),e.$on("isLoadingFalse",function(){e.isLoading=!1})}];return{templateUrl:"views/all/partials/templates/loading_banner.html",restrict:"AE",controller:e}}]).directive("signInBannerScope",["$rootScope",function(t){return{restrict:"AE",link:function(e,n,o){e.signInBanner={show:!1,bannerClass:"",msg:""},t.$on("signInBanner",function(t,n){e.signInBanner=n}),t.$on("clearBanners",function(){e.signInBanner={show:!1,bannerClass:"",msg:""}})}}}]).directive("registrationBannerScope",["$rootScope",function(t){return{restrict:"AE",link:function(e,n,o){e.registrationBanner={show:!1,bannerClass:"",msg:""},t.$on("registrationBanner",function(t,n){e.registrationBanner=n}),t.$on("clearBanners",function(){e.registrationBanner={show:!1,bannerClass:"",msg:""}})}}}]),angular.module("app").directive("contactUsScope",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(n,o,r){function a(e,n,o){var r=0;return e&&0!=e.length?n&&0!=n.length?o&&0!=o.length?0==r?1:void 0:(++r,t.showToast("warning","Message field is empty"),-1):(++r,t.showToast("warning","Please enter a valid email"),-1):(++r,t.showToast("warning","Please enter your name"),-1)}function i(t){return e.post("/contactUs",t)}n.contactUsModel={name:"",email:"",message:""},n.sendContactUs=function(){var e=a(n.contactUsModel.name,n.contactUsModel.email,n.contactUsModel.message);1==e&&i(n.contactUsModel).success(function(e){n.contactUsModel.name="",n.contactUsModel.email="",n.contactUsModel.message="",t.main.responseStatusHandler(e)}).error(function(e){t.main.responseStatusHandler(e)})}}}}]).directive("contactUs",[function(){return{templateUrl:"views/all/partials/components/contact_us.html",restrict:"AE",link:function(t,e,n){}}}]),angular.module("app").directive("createAccountScope",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(n,o,r){function a(t){return e.post("/createAccount",t)}n.registrationDetails={email:"",firstName:"",lastName:"",username:"",password1:"",password2:"",invitationCode:""},n.createAccount=function(){a(n.registrationDetails).success(function(e){t.main.responseStatusHandler(e)}).error(function(e){n.registrationDetails.password1="",n.registrationDetails.password2="",n.registrationDetails.invitationCode="",t.main.responseStatusHandler(e)})}}}}]),angular.module("app").directive("mainFooter",[function(){return{templateUrl:"views/all/partials/components/main_footer.html",restrict:"AE",link:function(t,e,n){}}}]),angular.module("app").directive("logoutScope",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(n,o,r){function a(){return e.post("/api/logoutClient")}n.logoutClient=function(){a().success(function(e){t.main.responseStatusHandler(e)}).error(function(e){t.main.responseStatusHandler(e)})}}}}]),angular.module("app").directive("postContent",["$filter",function(t){return{templateUrl:"views/all/partials/templates/post_content.html",scope:{postContent:"=model"},restrict:"AE",link:function(e,n,o){e.postContent=t("preparePostContent")(e.postContent)}}}]).directive("postSummary",["$filter",function(t){return{templateUrl:"views/all/partials/templates/post_summary.html",scope:{postSummary:"=model"},restrict:"AE",link:function(e,n,o){e.postSummary=t("preparePostSummary")(e.postSummary)}}}]).directive("postTags",["$filter",function(t){return{templateUrl:"views/all/partials/templates/post_tags.html",scope:{postTags:"=model"},restrict:"AE",link:function(t,e,n){}}}]),angular.module("app").directive("resendEmailScope",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(n,o,r){function a(t){return e.post("/resendConfirmationEmail",{userUniqueCuid:t})}n.resendConfirmationEmail=function(e){console.log(e),a(e).success(function(e){t.main.responseStatusHandler(e)}).error(function(e){t.main.responseStatusHandler(e)})}}}}]),angular.module("app").directive("signInScope",["$rootScope","$http",function(t,e){return{restrict:"AE",link:function(n,o,r){function a(t){return e.post("/localUserLogin",t)}n.loginFormModel={username:"",password:""},n.submitLocalLoginForm=function(){a(n.loginFormModel).success(function(e){t.main.responseStatusHandler(e)}).error(function(e){n.loginFormModel.password="",t.main.responseStatusHandler(e)})}}}}]),angular.module("app").directive("suggestedPosts",["$rootScope","$filter","$http",function(t,e,n){return{templateUrl:"views/all/partials/templates/suggested_posts.html",restrict:"AE",link:function(o,r,a){function i(){s().success(function(e){e.postsArray.length>0&&c(e.postsArray),t.main.responseStatusHandler(e)}).error(function(e){t.main.responseStatusHandler(e)})}function s(){return n.post("/api/getSuggestedPosts",{})}function c(t){o.suggestedPosts=t==[]?[]:e("preparePostsNoChange")(null,t)}o.suggestedPosts=[],o.suggestedPostsCount=0,i()}}}]),angular.module("app").directive("titleDirective",["globals",function(t){return{template:'<title ng-bind="defaultTitle"></title>',restrict:"AE",link:function(e,n,o){e.defaultTitle=t.getDocumentTitle(),e.$watch(t.getDocumentTitle,function(){e.defaultTitle=t.getDocumentTitle()})}}}]),angular.module("app").directive("universalSearchBoxScope",["$window","$location","$rootScope","globals",function(t,e,n,o){return{restrict:"AE",link:function(t,e,o){t.mainSearchModel={queryString:"",requestedPage:1},t.performMainSearch=function(){t.mainSearchModel.queryString.length>0&&n.main.redirectToPage("/search/posts/"+t.mainSearchModel.queryString+"/"+t.mainSearchModel.requestedPage)}}}}]),angular.module("app").controller("PopularStoriesController",["$q","$log","$scope","$rootScope","PopularStoriesService","globals",function(t,e,n,o,r,a){function i(){r.getPopularStoriesFromServer().success(function(t){o.main.responseStatusHandler(t),n.popularStories=r.updatePopularStories(t.popularStories)}).error(function(t){n.popularStories=r.updatePopularStories([]),o.main.responseStatusHandler(t)})}n.popularStories=r.getPopularStories(),i(),o.$on("reconnect",function(){i()})}]),angular.module("app").controller("UniversalController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","socketService","globals","$document",function(t,e,n,o,r,a,i,s,c,u,l,g){function p(){u.getUserData().success(function(t){s.main.responseStatusHandler(t),i.userData=l.userData(t.userData),s.main.broadcastUserData(),i.userData.isRegistered&&c.emit("joinRoom",{room:t.userData.uniqueCuid})}).error(function(t){s.main.responseStatusHandler(t)})}i.indexPageUrl=l.allData.indexPageUrl,s.currentHost=l.getLocationHost(),i.showDisqus=-1!==a.host().search("negusmath");var d=0;s.main={currentTime:"",showLoadingBannerDir:!1,showLoadingBanner:function(){this.showLoadingBannerDir=!0},hideLoadingBanner:function(){this.showLoadingBannerDir=!1},goToTop:function(){var t=angular.element(document.getElementById("top"));g.scrollToElement(t,80,d)},broadcastUserData:function(){s.$broadcast("userDataChanges")},responseStatusHandler:function(t){e("responseFilter")(t)},clearBanners:function(){s.$broadcast("clearBanners")},isLoading:!0,startLoading:function(){this.isLoading=!0},finishedLoading:function(){s.isLoading=!1},redirectToPage:function(t){r.location.href=l.getLocationHost()+t}},i.currentTime=moment().format("ddd, MMM D, H:mm");var m=function(){i.currentTime=moment().format("ddd, MMM D, H:mm")};o(m,2e4,0,!0),p();var f=[];s.stateHistory=[],s.$on("$stateChangeSuccess",function(t,e,n,o,r){f.push(a.$$path);var i={};i[o.name]=r,s.stateHistory.push(i)}),s.back=function(){window.history.back()},s.backAngular=function(){var t=f.length>1?f.splice(-2)[0]:"/";a.path(t)},s.$on("$stateChangeStart",function(t,e,n,o,r){s.main.clearBanners(),s.clearToasts()}),s.$on("reconnect",function(){p()})}]),angular.module("app").filter("timeago",[function(){return function(t,e,n){if(!t)return"never";if(e||(e=Date.now()),angular.isDate(t)?t=t.getTime():"string"==typeof t&&(t=new Date(t).getTime()),angular.isDate(e)?e=e.getTime():"string"==typeof e&&(e=new Date(e).getTime()),"number"==typeof t&&"number"==typeof e){var o=Math.abs((e-t)/1e3),r=[],a=60,i=3600,s=86400,c=604800,u=31556926,l=315569260;return r=a>=o?["",n?"now":"less than a minute"]:60*a>o?[Math.round(Math.abs(o/a)),"min"]:24*i>o?[Math.round(Math.abs(o/i)),"hr"]:7*s>o?[Math.round(Math.abs(o/s)),"day"]:52*c>o?[Math.round(Math.abs(o/c)),"week"]:10*u>o?[Math.round(Math.abs(o/u)),"year"]:100*l>o?[Math.round(Math.abs(o/l)),"decade"]:["","a long time"],r[1]+=0===r[0]||r[0]>1?"s":"",r=r.join(" "),n===!0?r:e>=t?r+" ago":"in "+r}}}]).filter("getTimeAgo",["$filter",function(t){return function(e){return t("timeago")(e)}}]).filter("getPostDate",[function(){return function(t){return moment(t).format("ddd, MMM D, H:mm")}}]).filter("getPostAbsoluteUrl",[function(){return function(t){return"http://www.negusmath.com/#!/home/post/"+t}}]).filter("getPostPath",[function(){return function(t){return"/#!/home/post/"+t}}]).filter("makeVideoIframesResponsive",[function(){return function(t,e){function n(t){return t.postSummary&&(o=$("<div>"+t.postSummary+"</div>"),r=$("img.ta-insert-video",o),r.length>0&&(a=r.addClass("embed-responsive-item").wrap("<div class='embed-responsive embed-responsive-16by9'></div>"),o.find("img").replaceWith(a)),t.postSummary=o.html()),t.postContent&&(o=$("<div>"+t.postContent+"</div>"),r=$("img.ta-insert-video",o),r.length>0&&(a=r.addClass("embed-responsive-item").wrap("<div class='embed-responsive embed-responsive-16by9'></div>"),o.find("img").replaceWith(a)),t.postContent=o.html()),t}var o,r,a;return t?Object.keys(t).length>0?n(t):t:e?(e.forEach(function(t,o){Object.keys(t).length>0&&(e[o]=n(t))}),e):void 0}}]).filter("getVideoResponsiveVersion",[function(){return function(t){function e(t){return n=$("<div>"+t+"</div>"),o=$("img.ta-insert-video",n),o.length>0&&(r=o.addClass("embed-responsive-item").wrap("<div class='embed-responsive embed-responsive-16by9'></div>"),n.find("img").replaceWith(r)),n.html()}var n,o,r;return t?e(t):t}}]).filter("highlightText",["$rootScope",function(t){return function(e,n){function o(){return"home.search"==t.$state.current.name?{status:!0,queryString:t.$stateParams.queryString||""}:t.stateHistory.length>0&&t.stateHistory[t.stateHistory.length-1].hasOwnProperty("home.search")&&"home.post"==t.$state.current.name?{status:!0,queryString:t.stateHistory[t.stateHistory.length-1]["home.search"].queryString}:{status:!1}}function r(t){if(n){var e=t,r=o();if(r.status===!0){var a=$("<div>"+t+"</div>");$(a).highlight(r.queryString),e=a.html()}else{var i=$("<div>"+t+"</div>");$(i).removeHighlight(),e=i.html()}}else{var s=$("<div>"+t+"</div>");$(s).removeHighlight(),e=s.html()}return e}return r(e)}}]).filter("preparePosts",["$filter",function(t){return function(e,n){function o(e){return e.length>0&&e.forEach(function(n,o){e[o].text=t("highlightText")(n.text,!0)}),e}function r(e){return e.timeAgo=t("getTimeAgo")(e.createdAt),e.postDate=t("getPostDate")(e.createdAt),e.postAbsoluteUrl=t("getPostAbsoluteUrl")(e.postIndex),e.postPath=t("getPostPath")(e.postIndex),e.postHeading=t("highlightText")(e.postHeading,!0),e.authorName=t("highlightText")(e.authorName,!0),e.postSummary=t("highlightText")(t("getVideoResponsiveVersion")(e.postSummary),!0),e.postContent=t("highlightText")(t("getVideoResponsiveVersion")(e.postContent),!0),e.postTags=o(e.postTags),e}return e?Object.keys(e).length>0?r(e):e:n?(n.forEach(function(t,e){Object.keys(t).length>0&&(n[e]=r(t))}),n):void 0}}]).filter("preparePostSummary",["$filter",function(t){return function(e){function n(n){return t("highlightText")(t("getVideoResponsiveVersion")(e),!0)}return console.log("postSummary called"),e?n(e):e}}]).filter("preparePostContent",["$filter",function(t){return function(e){function n(e){return t("highlightText")(t("getVideoResponsiveVersion")(e),!0)}return e?n(e):e}}]).filter("preparePostSummary",["$filter",function(t){return function(e){function n(e){return t("highlightText")(t("getVideoResponsiveVersion")(e),!0)}return e?n(e):e}}]).filter("removeHighlights",["$filter",function(t){return function(e,n){function o(e){return e.length>0&&e.forEach(function(n,o){e[o].text=t("highlightText")(n.text,!1)}),e}function r(e){return e.timeAgo=t("getTimeAgo")(e.createdAt),e.postDate=t("getPostDate")(e.createdAt),e.postAbsoluteUrl=t("getPostAbsoluteUrl")(e.postIndex),e.postPath=t("getPostPath")(e.postIndex),e.postHeading=t("highlightText")(e.postHeading,!1),e.authorName=t("highlightText")(e.authorName,!1),e.postSummary=t("highlightText")(e.postSummary,!1),e.postContent=t("highlightText")(e.postContent,!1),e.postTags=o(e.postTags),e}return e?Object.keys(e).length>0?r(e):e:n?(n.forEach(function(t,e){Object.keys(t).length>0&&(n[e]=r(t))}),n):void 0}}]).filter("preparePostsNoChange",["$filter",function(t){return function(e,n){function o(e){return e.timeAgo=t("getTimeAgo")(e.createdAt),e.postDate=t("getPostDate")(e.createdAt),e.postAbsoluteUrl=t("getPostAbsoluteUrl")(e.postIndex),e.postPath=t("getPostPath")(e.postIndex),e}return e?Object.keys(e).length>0?o(e):e:n?(n.forEach(function(t,e){Object.keys(t).length>0&&(n[e]=o(t))}),n):void 0}}]).filter("responseFilter",["$q","$log","$window","$rootScope",function(t,e,n,o){return function(t){function r(t,e,n){return{show:t?!0:!1,bannerClass:e,msg:n}}return null!==t&&"object"==typeof t&&(t.redirect&&t.redirect&&(n.location.href=t.redirectPage),t.notify&&t.type&&t.msg&&o.showToast(t.type,t.msg),t.banner&&t.bannerClass&&t.msg&&o.$broadcast("universalBanner",r(!0,t.bannerClass,t.msg)),t.newPostBanner&&t.bannerClass&&t.msg&&o.$broadcast("newPostBanner",r(!0,t.bannerClass,t.msg)),t.signInBanner&&t.bannerClass&&t.msg&&o.$broadcast("signInBanner",r(!0,t.bannerClass,t.msg)),t.registrationBanner&&t.bannerClass&&t.msg&&o.$broadcast("registrationBanner",r(!0,t.bannerClass,t.msg)),t.reason&&e.warn(t.reason)),!0}}]),angular.module("app").factory("fN",["$q","$location","$window","$rootScope","socketService",function(t,e,n,o,r){return{calcObjectLength:function(t){var e=0;for(var n in t)t.hasOwnProperty(n)&&e++;return e}}}]),angular.module("app").factory("globals",["$q","$location","$rootScope",function(t,e,n){var o={},r={documentTitle:"Negus Math - College Level Advanced Mathematics for Kenya Students",indexPageUrl:e.port()?"http://"+e.host()+":"+e.port()+"/index":$scope.indexPageUrl="http://"+e.host()+"/index"};return{userData:function(t){return t?o=t:o},allData:r,getDocumentTitle:function(){return r.documentTitle},defaultDocumentTitle:function(){r.documentTitle="Negus Math - College Level Advanced Mathematics for Kenya Students"},changeDocumentTitle:function(t){return t&&(r.documentTitle=t),r.documentTitle},getLocationHost:function(){return-1!==document.location.hostname.search("negusmath")?"//www.negusmath.com":e.port()?"http://localhost:"+e.port():"http://localhost"},checkAccountStatus:function(){function t(t){return t&&Object.keys(t)>0?t.isRegistered?t.emailIsConfirmed?t.isApproved===!1?{show:!0,bannerClass:"alert alert-warning",msg:"Your account is awaiting approval from the administrators. Please allow up to 3 business days. You will get an email notification as soon as your account is approved.",showResendEmail:!1,accountStatus:!1}:t.isBanned&&t.isBanned.status===!0?{show:!0,bannerClass:"alert alert-warning",msg:"Your have been banned from this service. Please contact the administrators for more information",showResendEmail:!1,accountStatus:!1}:{show:!1,bannerClass:"",msg:"",showResendEmail:!1,accountStatus:!0}:{show:!0,bannerClass:"alert alert-warning",msg:"Please confirm your account by clicking the confirmation link we sent on your email. Please also check your spam folder",showResendEmail:!0,accountStatus:!1}:(console.log(t),{show:!0,bannerClass:"alert alert-warning",msg:"You are not registered. Please reload this page to create an account",showResendEmail:!1,accountStatus:!1}):{show:!1,bannerClass:"",msg:"",showResendEmail:!1,accountStatus:!0}}var e=t(o);return n.$broadcast("universalBanner",e),e.accountStatus}}}]),angular.module("app").factory("mainService",["$log","$window","$rootScope","socket",function(t,e,n,o){return o.on("reconnect",function(){t.info("'reconnect sequence' triggered"),n.$broadcast("reconnect")}),{done:function(){return 1}}}]),angular.module("app").factory("PopularStoriesService",["$filter","$log","$http","$window","$rootScope","socket",function(t,e,n,o,r,a){var i=[];return{getPopularStories:function(){return i},getPopularStoriesFromServer:function(){return n.post("/api/getPopularStories",{})},updatePopularStories:function(e){return i=e==[]?[]:t("preparePostsNoChange")(null,e),e}}}]),angular.module("app").factory("socket",["$log","$location","$rootScope",function(t,e,n){var o;o=-1!==document.location.hostname.search("negusmath")?"//www.negusmath.com":e.port()?"http://localhost:"+e.port():"http://localhost";var r=io.connect(o);return{on:function(t,e){r.on(t,function(){var t=arguments;n.$apply(function(){e.apply(r,t)})})},emit:function(t,e,o){r.emit(t,e,function(){var t=arguments;n.$apply(function(){o&&o.apply(r,t)})})},removeAllListeners:function(t,e){r.removeAllListeners(t,function(){var t=arguments;n.$apply(function(){e.apply(r,t)})})}}}]).factory("socketService",["$log","$http","$rootScope",function(t,e,n){return{getUserData:function(){return e.get("/api/getUserData")},createAccount:function(t){return e.post("/createAccount",t)},localUserLogin:function(t){return e.post("/localUserLogin",t)},resendConfirmationEmail:function(t){return e.post("/resendConfirmationEmail",{userUniqueCuid:t})},sendContactUs:function(t){return e.post("/contactUs",t)}}}]).factory("logoutService",["$http",function(t){return{logoutClient:function(){return t.post("/api/logoutClient")}}}]),angular.module("app").run(["$templateCache","$http","$rootScope","$state","$stateParams",function(t,e,n,o,r){n.$state=o,n.$stateParams=r,n.Utils={keys:Object.keys}}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,n){}]).value("duScrollOffset",60),angular.module("app").controller("MainController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals",function(t,e,n,o,r,a,i,s,c,u,l,g){i.checkAccountStatus=function(t){return t&&t.isRegistered?0==t.emailIsConfirmed?!1:t.isApproved===!1?!1:t.isBanned&&t.isBanned.status===!0?!1:!0:!1},i.accountStatusIsGood=!1,s.$on("userDataChanges",function(){i.accountStatusIsGood=i.checkAccountStatus(g.userData)})}]);
//# sourceMappingURL=concatenated.min.js.map