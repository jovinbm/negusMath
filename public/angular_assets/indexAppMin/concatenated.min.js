angular.module("indexApp",["ui.bootstrap","angular-loading-bar","angulartics","angulartics.google.analytics","angularMoment","ui.router","duScroll","ngFx","ngAnimate","ui.utils"]).run(["$templateCache","$http",function(e,n){}]),angular.module("indexApp").directive("accountOuter",["$rootScope",function(e,n){return{templateUrl:"views/index/views/account_outer.html",restrict:"AE",link:function(e,n,t){e.userLoginState="signIn",e.changeUserLoginState=function(n){e.userLoginState=n}}}}]),angular.module("indexApp").directive("accountStatusBanner",["$rootScope","socketService","globals","$location","$window",function(e,n,t,r,a){return{scope:{},templateUrl:"views/general/smalls/account_status.html",restrict:"AE",link:function(t,r,a){function o(){n.getUserData().success(function(e){t.theUser=e.userData,1==e.userData.isRegistered&&(t.accountStatusBanner=s(e.userData))}).error(function(){t.accountStatusBanner={show:!0,bannerClass:"alert alert-warning",msg:"An error has occurred. Please reload page"}})}function s(e){return e.isRegistered?e.emailIsConfirmed?e.isApproved===!1?{show:!0,bannerClass:"alert alert-warning",msg:"Your account is awaiting approval from the administrators. Please allow up to 3 business days. You will get an email notification as soon as your account is approved.",showResendEmail:!1}:e.isBanned&&e.isBanned.status===!0?{show:!0,bannerClass:"alert alert-warning",msg:"Your have been banned from this service. Please contact the administrators for more information",showResendEmail:!1}:{show:!1,bannerClass:"",msg:"",showResendEmail:!1}:{show:!0,bannerClass:"alert alert-warning",msg:"Please confirm your account by clicking the confirmation link we sent on your email. Please also check your spam folder",showResendEmail:!0}:{show:!1,bannerClass:"",msg:"",showResendEmail:!1}}t.accountStatusBanner={show:!1,bannerClass:"",msg:"",showResendEmail:!1},t.resendConfirmationEmail=function(t){n.resendConfirmationEmail(t).success(function(n){e.responseStatusHandler(n)}).error(function(n){e.responseStatusHandler(n)})},o(),e.$on("userDataChanges",function(){}),e.$on("reconnect",function(){o()})}}}]).directive("signInBanner",["$rootScope",function(e){return{templateUrl:"views/index/smalls/sign_in_banner.html",restrict:"AE",link:function(n,t,r){n.signInBanner={show:!1,bannerClass:"",msg:""},e.$on("signInBanner",function(e,t){n.signInBanner=t}),e.$on("clearBanners",function(){n.signInBanner={show:!1,bannerClass:"",msg:""}})}}}]).directive("registrationBanner",["$rootScope",function(e){return{templateUrl:"views/index/smalls/registration_banner.html",restrict:"AE",link:function(n,t,r){n.registrationBanner={show:!1,bannerClass:"",msg:""},e.$on("registrationBanner",function(e,t){n.registrationBanner=t}),e.$on("clearBanners",function(){n.registrationBanner={show:!1,bannerClass:"",msg:""}})}}}]).directive("toastrDirective",["$rootScope",function(e){return{restrict:"AE",link:function(n,t,r){e.showToast=function(e,n){switch(e){case"success":toastr.clear(),toastr.success(n);break;case"warning":toastr.clear(),toastr.warning(n,"Warning",{closeButton:!0,tapToDismiss:!0});break;case"error":toastr.clear(),toastr.error(n,"Error",{closeButton:!0,tapToDismiss:!0,timeOut:!1});break;default:toastr.clear()}},e.clearToasts=function(){toastr.clear()}}}}]).directive("loadingBanner",["$rootScope",function(e){var n=["$scope","$rootScope","cfpLoadingBar",function(e,n,t){n.isLoading=!1,n.isLoadingPercentage=0,n.changeIsLoadingPercentage=function(e){n.isLoadingPercentage=e},n.showHideLoadingBanner=function(e){e?($("#loading-splash-card").removeClass("hidden"),$(".hideMobileLoading").addClass("hidden-xs hidden-sm")):($("#loading-splash-card").addClass("hidden"),$(".hideMobileLoading").removeClass("hidden-xs hidden-sm"))},n.$on("cfpLoadingBar:loading",function(e,r){n.isLoadingPercentage=100*t.status()}),n.$on("cfpLoadingBar:loaded",function(e,r){n.isLoadingPercentage=100*t.status()}),n.$on("cfpLoadingBar:completed",function(e,r){n.isLoadingPercentage=100*t.status()}),n.isLoadingTrue=function(){n.isLoading=!0},n.isLoadingFalse=function(){n.isLoading=!1},n.$on("isLoadingTrue",function(){n.isLoading=!0}),n.$on("isLoadingFalse",function(){n.isLoading=!1})}];return{templateUrl:"views/client/partials/smalls/loading_banner.html",restrict:"AE",controller:n}}]),angular.module("indexApp").directive("createAccount",["$rootScope","socketService",function(e,n){return{templateUrl:"views/index/views/create_account.html",restrict:"AE",link:function(t,r,a){t.registrationDetails={email:"",firstName:"",lastName:"",username:"",password1:"",password2:"",invitationCode:""},t.createAccount=function(){n.createAccount(t.registrationDetails).success(function(n){e.responseStatusHandler(n)}).error(function(n){t.registrationDetails.password1="",t.registrationDetails.password2="",t.registrationDetails.invitationCode="",e.responseStatusHandler(n)})}}}}]),angular.module("indexApp").directive("signIn",["$rootScope","socketService",function(e,n){return{templateUrl:"views/index/views/sign_in.html",restrict:"AE",link:function(t,r,a){t.loginFormModel={username:"",password:""},t.submitLocalLoginForm=function(){n.localUserLogin(t.loginFormModel).success(function(n){e.responseStatusHandler(n)}).error(function(n){t.loginFormModel.password="",e.responseStatusHandler(n)})}}}}]),angular.module("indexApp").directive("universalSearchBox",["$window","$location","$rootScope","globals",function(e,n,t,r){return{templateUrl:"views/admin/partials/smalls/universal_search_box.html",restrict:"AE",link:function(r,a,o){r.mainSearchModel={queryString:"",postSearchUniqueCuid:"",requestedPage:1},r.fillSearchBox=function(){r.mainSearchModel.queryString="search"==t.$state.current.name?t.$stateParams.queryString?t.$stateParams.queryString:"":t.stateHistory.length>0&&t.stateHistory[t.stateHistory.length-1].hasOwnProperty("search")?t.stateHistory[t.stateHistory.length-1].search.queryString:""},r.fillSearchBox(),r.performMainSearch=function(){r.mainSearchModel.queryString.length>0&&(e.location.href=n.port()?"http://"+n.host()+":"+n.port()+"/#!/search/"+r.mainSearchModel.queryString+"/1":"http://"+n.host()+"/#!/search/"+r.mainSearchModel.queryString+"/1")}}}}]).directive("topNav",["$rootScope","logoutService",function(e,n){return{templateUrl:"views/index/views/top_nav.html",restrict:"AE",link:function(t,r,a){t.logoutClient=function(){n.logoutClient().success(function(n){e.responseStatusHandler(n)}).error(function(n){e.responseStatusHandler(n)})}}}}]).directive("mainFooter",[function(){return{templateUrl:"views/general/smalls/main_footer.html",restrict:"AE",link:function(e,n,t){}}}]).directive("contactUs",["$rootScope","socketService",function(e,n){return{templateUrl:"views/general/smalls/contact_us.html",restrict:"AE",link:function(t,r,a){function o(n,t,r){var a=0;return n&&0!=n.length?t&&0!=t.length?r&&0!=r.length?0==a?1:void 0:(++a,e.showToast("warning","Message field is empty"),-1):(++a,e.showToast("warning","Please enter a valid email"),-1):(++a,e.showToast("warning","Please enter your name"),-1)}t.contactUsModel={name:"",email:"",message:""},t.sendContactUs=function(){var r=o(t.contactUsModel.name,t.contactUsModel.email,t.contactUsModel.message);1==r&&n.sendContactUs(t.contactUsModel).success(function(n){t.contactUsModel.name="",t.contactUsModel.email="",t.contactUsModel.message="",e.responseStatusHandler(n)}).error(function(n){e.responseStatusHandler(n)})}}}}]),angular.module("indexApp").controller("MainController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals",function(e,n,t,r,a,o,s,i,c,l,u,d){function g(){u.getUserData().success(function(e){s.userData=d.userData(e.userData),s.broadcastUserData(),s.clientIsRegistered=s.userData.isRegistered,s.accountStatusIsGood=s.checkAccountStatus(s.userData),s.userData.isRegistered&&c.emit("joinRoom",{room:e.userData.uniqueCuid}),i.responseStatusHandler(e)}).error(function(e){i.responseStatusHandler(e)})}s.indexPageUrl=d.allData.indexPageUrl,i.responseStatusHandler=function(e){n("responseFilter")(e)},s.checkAccountStatus=function(e){return e&&e.isRegistered?0==e.emailIsConfirmed?!1:e.isApproved===!1?!1:e.isBanned&&e.isBanned.status===!0?!1:!0:!1},s.broadcastUserData=function(){i.$broadcast("userDataChanges")},s.clientIsRegistered=!1,s.accountStatusIsGood=!1,g(),i.$on("reconnectSuccess",function(){g()})}]),angular.module("indexApp").filter("timeago",function(){return function(e,n,t){if(!e)return"never";if(n||(n=Date.now()),angular.isDate(e)?e=e.getTime():"string"==typeof e&&(e=new Date(e).getTime()),angular.isDate(n)?n=n.getTime():"string"==typeof n&&(n=new Date(n).getTime()),"number"==typeof e&&"number"==typeof n){var r=Math.abs((n-e)/1e3),a=[],o=60,s=3600,i=86400,c=604800,l=31556926,u=315569260;return a=o>=r?["",t?"now":"less than a minute"]:60*o>r?[Math.round(Math.abs(r/o)),"min"]:24*s>r?[Math.round(Math.abs(r/s)),"hr"]:7*i>r?[Math.round(Math.abs(r/i)),"day"]:52*c>r?[Math.round(Math.abs(r/c)),"week"]:10*l>r?[Math.round(Math.abs(r/l)),"year"]:100*u>r?[Math.round(Math.abs(r/u)),"decade"]:["","a long time"],a[1]+=0===a[0]||a[0]>1?"s":"",a=a.join(" "),t===!0?a:n>=e?a+" ago":"in "+a}}}).filter("getTimeAgo",["$filter",function(e){return function(n){return e("timeago")(n)}}]).filter("getPostDate",["$filter",function(){return function(e){return moment(e).format("ddd, MMM D, H:mm")}}]).filter("makeVideoIframesResponsive",["$filter",function(){return function(e,n){function t(e){return e.postHeading&&(r=$("<div>"+e.postHeading+"</div>"),a=$("img.ta-insert-video",r),a.length>0&&(o=a.addClass("embed-responsive-item").wrap("<div class='embed-responsive embed-responsive-16by9'></div>"),r.find("img").replaceWith(o)),e.postHeading=r.html()),e.postContent&&(r=$("<div>"+e.postContent+"</div>"),a=$("img.ta-insert-video",r),a.length>0&&(o=a.addClass("embed-responsive-item").wrap("<div class='embed-responsive embed-responsive-16by9'></div>"),r.find("img").replaceWith(o)),e.postContent=r.html()),e}var r,a,o;return e?t(e):n?(n.forEach(function(e,r){n[r]=t(e)}),n):void 0}}]).filter("highlightText",["$filter","$rootScope",function(e,n){return function(e){function t(){return"search"==n.$state.current.name?{status:!0,queryString:n.$stateParams.queryString||""}:n.stateHistory.length>0&&n.stateHistory[n.stateHistory.length-1].hasOwnProperty("search")?{status:!0,queryString:n.stateHistory[n.stateHistory.length-1].search.queryString}:{status:!1}}function r(e){var n=e,r=t();if(r.status===!0){var a=$("<div>"+e+"</div>");$(a).highlight(r.queryString),n=a.html()}else{var o=$("<div>"+e+"</div>");$(o).removeHighlight(),n=o.html()}return n}return r(e)}}]).filter("responseFilter",["$q","$filter","$log","$interval","$window","$location","$rootScope","globals",function(e,n,t,r,a,o,s,i){return function(e){function n(e,n,t){return{show:e?!0:!1,bannerClass:n,msg:t}}return s.universalDisable=!1,e&&(e.redirect&&e.redirect&&(a.location.href=e.redirectPage),e.disable&&(s.universalDisable=!0),e.notify&&e.type&&e.msg&&s.showToast(e.type,e.msg),e.banner&&e.bannerClass&&e.msg&&s.$broadcast("universalBanner",n(!0,e.bannerClass,e.msg)),e.newPostBanner&&e.bannerClass&&e.msg&&s.$broadcast("newPostBanner",n(!0,e.bannerClass,e.msg)),e.signInBanner&&e.bannerClass&&e.msg&&s.$broadcast("signInBanner",n(!0,e.bannerClass,e.msg)),e.registrationBanner&&e.bannerClass&&e.msg&&s.$broadcast("registrationBanner",n(!0,e.bannerClass,e.msg)),e.reason&&t.warn(e.reason)),!0}}]),angular.module("indexApp").factory("fN",["$q","$location","$window","$rootScope","socketService",function(e,n,t,r,a){return{calcObjectLength:function(e){var n=0;for(var t in e)e.hasOwnProperty(t)&&n++;return n}}}]),angular.module("indexApp").factory("globals",["$q","$location","$window","$rootScope","socketService",function(e,n,t,r,a){var o={},s={documentTitle:"Negus Math - College Level Advanced Mathematics for Kenya Students",indexPageUrl:n.port()?"http://"+n.host()+":"+n.port()+"/index":$scope.indexPageUrl="http://"+n.host()+"/index"};return{userData:function(e){return e?o=e:o},allData:s,getDocumentTitle:function(){return s.documentTitle},defaultDocumentTitle:function(){s.documentTitle="Negus Math - College Level Advanced Mathematics for Kenya Students"},changeDocumentTitle:function(e){return e&&(s.documentTitle=e),s.documentTitle},getLocationHost:function(){return n.port()?"http://"+n.host()+":"+n.port():"http://"+n.host()}}}]),angular.module("indexApp").factory("mainService",["$log","$window","$rootScope","socket","socketService","globals",function(e,n,t,r,a,o){return r.on("reconnect",function(){e.info("'reconnect sequence' triggered"),t.$broadcast("reconnectSuccess")}),{done:function(){return 1}}}]),angular.module("indexApp").factory("socket",["$log","$location","$rootScope",function(e,n,t){var r;r=n.port()?n.host()+":"+n.port():n.host();var a=io.connect(r);return{on:function(e,n){a.on(e,function(){var e=arguments;t.$apply(function(){n.apply(a,e)})})},emit:function(e,n,r){a.emit(e,n,function(){var e=arguments;t.$apply(function(){r&&r.apply(a,e)})})},removeAllListeners:function(e,n){a.removeAllListeners(e,function(){var e=arguments;t.$apply(function(){n.apply(a,e)})})}}}]).factory("socketService",["$log","$http","$rootScope",function(e,n,t){return{getUserData:function(){return n.get("/api/getUserData")},createAccount:function(e){return n.post("/createAccount",e)},localUserLogin:function(e){return n.post("/localUserLogin",e)},resendConfirmationEmail:function(e){return n.post("/resendConfirmationEmail",{userUniqueCuid:e})},sendContactUs:function(e){return n.post("/contactUs",e)}}}]).factory("logoutService",["$http",function(e){return{logoutClient:function(){return e.post("/api/logoutClient")}}}]);
//# sourceMappingURL=concatenated.min.js.map