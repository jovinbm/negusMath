angular.module("clientHomeApp",["ui.bootstrap","angular-loading-bar","angulartics","angulartics.google.analytics","angularMoment","ui.router","duScroll","ngFx","ngAnimate","textAngular","ngSanitize","angularUtils.directives.dirDisqus"]).run(["$templateCache","$http",function(e,t){t.get("views/client/partials/views/post_stream.html",{cache:e}),t.get("views/client/partials/views/full_post.html",{cache:e})}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){t.otherwise("/home/1"),e.state("home",{url:"/home/:pageNumber",templateUrl:"views/client/partials/views/post_stream.html"}).state("post",{url:"/post/:postIndex",templateUrl:"views/client/partials/views/full_post.html"}).state("otherwise",{url:"/home/1"}),o.html5Mode(!1).hashPrefix("!")}]),angular.module("clientHomeApp").filter("timeago",function(){return function(e,t,o){if(!e)return"never";if(t||(t=Date.now()),angular.isDate(e)?e=e.getTime():"string"==typeof e&&(e=new Date(e).getTime()),angular.isDate(t)?t=t.getTime():"string"==typeof t&&(t=new Date(t).getTime()),"number"==typeof e&&"number"==typeof t){var s=Math.abs((t-e)/1e3),n=[],r=60,a=3600,i=86400,c=604800,u=31556926,l=315569260;return n=r>=s?["",o?"now":"less than a minute"]:60*r>s?[Math.round(Math.abs(s/r)),"min"]:24*a>s?[Math.round(Math.abs(s/a)),"hr"]:7*i>s?[Math.round(Math.abs(s/i)),"day"]:52*c>s?[Math.round(Math.abs(s/c)),"week"]:10*u>s?[Math.round(Math.abs(s/u)),"year"]:100*l>s?[Math.round(Math.abs(s/l)),"decade"]:["","a long time"],n[1]+=0===n[0]||n[0]>1?"s":"",n=n.join(" "),o===!0?n:t>=e?n+" ago":"in "+n}}}),angular.module("clientHomeApp").controller("HotController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams","HotService",function(e,t,o,s,n,r,a,i,c,u,l,g,p,d,m,f){function h(){f.getHotThisWeekFromServer().success(function(e){a.hotThisWeek=f.updateHotThisWeek(e.hotThisWeek),v()}).error(function(e){a.responseStatusHandler(e)})}function v(){a.hotThisWeek.forEach(function(e){e.theTimeAgo=t("timeago")(e.createdAt),e.postDate=moment(e.createdAt).format("ddd, MMM D, H:mm")})}a.hotThisWeek=f.getHotThisWeek(),h(),s(v,12e4,0,!0),v(),i.$on("reconnect",function(){h()}),o.info("PostController booted successfully")}]),angular.module("clientHomeApp").controller("MainController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$document","$state","$stateParams",function(e,t,o,s,n,r,a,i,c,u,l,g,p,d,m,f,h){i.$on("$stateChangeSuccess",function(e,t,o,s,n){a.currentState=t.name});var v=[];i.$on("$routeChangeSuccess",function(){v.push(r.$$path)}),i.back=function(){var e=v.length>1?v.splice(-2)[0]:"/";r.path(e)},a.calcObjectLength=function(e){var t=0;for(var o in e)e.hasOwnProperty(o)&&t++;return t};var P=0;a.goToTop=function(){var e=angular.element(document.getElementById("top"));m.scrollToElement(e,80,P)},a.goToUniversalBanner=function(){var e=angular.element(document.getElementById("universalBanner"));m.scrollToElement(e,80,P)},a.makeVideoIframesResponsive=function(e){var t=$("<div>"+e+"</div>"),o=$("img.ta-insert-video",t);if(o.length>0){var s=o.addClass("embed-responsive-item").wrap("<div class='embed-responsive embed-responsive-16by9'></div>");t.find("img").replaceWith(s)}return t.html()},a.universalDisable=!1,a.showBanner=!1,a.bannerClass="",a.bannerMessage="",a.showRegistrationBanner=!1,a.registrationBannerClass="",a.registrationBannerMessage="",a.showNewPostBanner=!1,a.newPostBannerClass="",a.newPostBannerMessage="",a.clearBanners=function(){a.showBanner=!1,a.showRegistrationBanner=!1,a.showNewPostBanner=!1},i.$on("$stateChangeSuccess",function(e,t,o,s,n){a.clearBanners()}),a.universalDisableTrue=function(){a.universalDisable=!0},a.universalDisableFalse=function(){a.universalDisable=!1},a.responseStatusHandler=function(e){e&&(e.redirect&&e.redirect&&(n.location.href=e.redirectPage),e.disable&&e.disable&&a.universalDisableTrue(),e.notify&&e.type&&e.msg&&a.showToast(e.type,e.msg),e.banner&&e.bannerClass&&e.msg&&(a.showBanner=!0,a.bannerClass=e.bannerClass,a.bannerMessage=e.msg),e.newPostBanner&&e.bannerClass&&e.msg&&(a.showNewPostBanner=!0,a.newPostBannerClass=e.bannerClass,a.newPostBannerMessage=e.msg),e.registrationBanner&&e.bannerClass&&e.msg&&(a.showRegistrationBanner=!0,a.registrationBannerClass=e.bannerClass,a.registrationBannerMessage=e.msg),e.reason&&o.warn(e.reason))},i.$on("responseStatusHandler",function(e,t){a.responseStatusHandler(t)}),a.isLoading=!1,a.isLoadingTrue=function(){a.isLoading=!0},a.isLoadingFalse=function(){a.isLoading=!1},i.$on("isLoadingTrue",function(){a.isLoading=!0}),i.$on("isLoadingFalse",function(){a.isLoading=!1}),a.showToast=function(e,t){switch(e){case"success":toastr.clear(),toastr.success(t);break;case"warning":toastr.clear(),toastr.warning(t,"Warning",{closeButton:!0,tapToDismiss:!0});break;case"error":toastr.clear(),toastr.error(t,"Error",{closeButton:!0,tapToDismiss:!0,timeOut:!1});break;default:toastr.clear()}},i.$on("showToast",function(e,t){var o=t.toastType,s=t.text;a.showToast(o,s)}),a.currentTime="",a.currentTime=moment().format("ddd, MMM D, H:mm");var w=function(){a.currentTime=moment().format("ddd, MMM D, H:mm")};s(w,2e4,0,!0),a.goToLandingPage=function(){n.location.href="index"},i.$on("reconnect",function(){}),o.info("MainController booted successfully")}]),angular.module("clientHomeApp").controller("PostsController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams",function(e,t,o,s,n,r,a,i,c,u,l,g,p,d,m){function f(){a.posts.forEach(function(e){e.postSummary=a.makeVideoIframesResponsive(e.postSummary)})}function h(){a.suggestedPosts=[],d.getSuggestedPostsFromServer().success(function(e){function t(){a.suggestedPosts.forEach(function(e){e.postSummary=a.makeVideoIframesResponsive(e.postSummary)})}e.postsArray.length>0?(a.showSuggestedPostsOnly(),a.suggestedPosts=e.postsArray,P(),t()):(a.suggestedPosts=[],a.showSuggestedPosts=!1,a.goToUniversalBanner())}).error(function(e){a.goToUniversalBanner(),a.suggestedPosts=[],a.showSuggestedPosts=!1,a.responseStatusHandler(e)})}function v(){d.getPostsFromServer(m.pageNumber).success(function(e){if(0==e.postsArray.length){a.posts=[];var t={banner:!0,bannerClass:"alert alert-dismissible alert-success",msg:"No more posts to show"};a.responseStatusHandler(t),a.showPosts=!1,h(),a.goToUniversalBanner()}else a.posts=d.updatePosts(e.postsArray),a.showThePostsOnly(),P(),e.postCount&&(a.postsCount=e.postsCount),f()}).error(function(e){a.responseStatusHandler(e),a.posts=[],a.showPosts=!1,h()})}function P(){a.posts.forEach(function(e){e.theTimeAgo=t("timeago")(e.createdAt),e.postDate=moment(e.createdAt).format("ddd, MMM D, H:mm")})}a.posts=d.getCurrentPosts(),a.postsCount=d.getCurrentPostsCount(),a.suggestedPosts=[],a.showPosts=!1,a.showSuggestedPosts=!1,a.showThePostsOnly=function(){a.showPosts=!0,a.showSuggestedPosts=!1},a.showSuggestedPostsOnly=function(){a.showPosts=!1,a.showSuggestedPosts=!0},v(),a.checkIfPostsIsEmpty=function(){return 0==a.posts.length},s(P,12e4,0,!0),P(),i.$on("newPost",function(e,t){1==m.pageNumber&&(a.posts.unshift(t.post),P(),f()),t.postCount&&(a.postCount=t.postCount)}),i.$on("reconnect",function(){v()}),o.info("PostController booted successfully")}]).controller("FullPostController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams",function(e,t,o,s,n,r,a,i,c,u,l,g,p,d,m){function f(){a.suggestedPosts=[],d.getSuggestedPostsFromServer().success(function(e){function t(){a.suggestedPosts.forEach(function(e){e.postSummary=a.makeVideoIframesResponsive(e.postSummary)})}e.postsArray.length>0?(a.showSuggestedPostsOnly(),a.suggestedPosts=e.postsArray,v(),t()):(a.suggestedPosts=[],a.showSuggestedPosts=!1,a.goToUniversalBanner())}).error(function(e){a.goToUniversalBanner(),a.suggestedPosts=[],a.showSuggestedPosts=!1,a.responseStatusHandler(e)})}function h(){d.getPostFromServer(a.postIndex).success(function(e){function t(){a.post.postContent=a.makeVideoIframesResponsive(a.post.postContent)}a.post=e.thePost,a.responseStatusHandler(e),0!=a.calcObjectLength(a.post)?(a.showThePostOnly(),v(),P(),a.postIsLoaded=!0,t()):(a.post={},a.showPost=!1,f(),a.goToUniversalBanner())}).error(function(e){a.responseStatusHandler(e),a.post={},a.showPost=!1,f()})}function v(){a.post&&(a.post.theTimeAgo=t("timeago")(a.post.createdAt),a.post.postDate=moment(a.post.createdAt).format("ddd, MMM D, H:mm")),a.suggestedPosts&&a.suggestedPosts.forEach(function(e){e.theTimeAgo=t("timeago")(e.createdAt),e.postDate=moment(e.createdAt).format("ddd, MMM D, H:mm")})}function P(){a.post.postUrl="http://"+r.host()+"/#!/post/"+a.post.postIndex}a.postIndex=m.postIndex,a.post={},a.suggestedPosts=[],a.showPost=!1,a.showSuggestedPosts=!1,a.showThePostOnly=function(){a.showPost=!0,a.showSuggestedPosts=!1},a.showSuggestedPostsOnly=function(){a.showPost=!1,a.showSuggestedPosts=!0},a.postIsLoaded=!1,h(),s(v,12e4,0,!0),i.$on("postUpdate",function(e,t){a.post=t.post,v()}),i.$on("reconnect",function(){a.editingMode||h()}),o.info("FullPostController booted successfully")}]),angular.module("clientHomeApp").factory("globals",["$q","$window","$rootScope","socketService",function(e,t,o,s){var n={};return{userData:function(e){return e?n=e:n}}}]),angular.module("clientHomeApp").factory("HotService",["$log","$http","$window","$rootScope","socket","socketService","globals",function(e,t,o,s,n,r,a){var i=[];return n.on("hotThisWeekPosts",function(e){s.$broadcast("hotThisWeekPosts",e)}),{getHotThisWeek:function(){return i},getHotThisWeekFromServer:function(){return t.post("/api/getHotThisWeek",{})},updateHotThisWeek:function(e){return i=e,e}}}]),angular.module("clientHomeApp").factory("mainService",["$log","$window","$rootScope","socket","socketService","globals",function(e,t,o,s,n,r){return s.on("reconnect",function(){e.info("'reconnect sequence' triggered"),o.$broadcast("reconnect")}),{done:function(){return 1}}}]),angular.module("clientHomeApp").factory("PostService",["$log","$http","$window","$rootScope","socket","socketService","globals",function(e,t,o,s,n,r,a,i){var c=[],u=0;return n.on("newPost",function(e){s.$broadcast("newPost",e)}),n.on("postUpdate",function(e){s.$broadcast("postUpdate",e)}),{getCurrentPosts:function(){return c},getCurrentPostsCount:function(){return u},getPostsFromServer:function(e){return t.post("/api/getPosts",{page:e})},getSuggestedPostsFromServer:function(){return t.post("/api/getSuggestedPosts",{})},updatePosts:function(e){return c=e,e},getPostFromServer:function(e){return t.post("/api/getPost",{postIndex:e})}}}]),angular.module("clientHomeApp").factory("socket",["$log","$location","$rootScope",function(e,t,o){var s;s=t.port()?t.host()+":"+t.port():t.host();var n=io.connect(s);return{on:function(e,t){n.on(e,function(){var e=arguments;o.$apply(function(){t.apply(n,e)})})},emit:function(e,t,s){n.emit(e,t,function(){var e=arguments;o.$apply(function(){s&&s.apply(n,e)})})},removeAllListeners:function(e,t){n.removeAllListeners(e,function(){var e=arguments;o.$apply(function(){t.apply(n,e)})})}}}]).factory("socketService",["$log","$http","$rootScope",function(e,t,o){return{sendContactUs:function(e){return t.post("/contactUs",e)}}}]);
//# sourceMappingURL=concatenated.min.js.map