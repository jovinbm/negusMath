angular.module("clientHomeApp",["ui.bootstrap","angular-loading-bar","cfp.loadingBar","angulartics","angulartics.google.analytics","angularMoment","ui.router","duScroll","ngFx","ngAnimate","textAngular","ngSanitize","angularUtils.directives.dirDisqus"]).run(["$templateCache","$http",function(e,t){t.get("views/client/partials/views/post_stream.html",{cache:e}),t.get("views/client/partials/views/full_post.html",{cache:e})}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){t.otherwise("/home/1"),e.state("home",{url:"/home/:pageNumber",templateUrl:"views/client/partials/views/post_stream.html"}).state("post",{url:"/post/:postIndex",templateUrl:"views/client/partials/views/full_post.html"}).state("otherwise",{url:"/home/1"}),o.html5Mode(!1).hashPrefix("!")}]),angular.module("clientHomeApp").filter("timeago",function(){return function(e,t,o){if(!e)return"never";if(t||(t=Date.now()),angular.isDate(e)?e=e.getTime():"string"==typeof e&&(e=new Date(e).getTime()),angular.isDate(t)?t=t.getTime():"string"==typeof t&&(t=new Date(t).getTime()),"number"==typeof e&&"number"==typeof t){var n=Math.abs((t-e)/1e3),s=[],a=60,r=3600,i=86400,c=604800,u=31556926,l=315569260;return s=a>=n?["",o?"now":"less than a minute"]:60*a>n?[Math.round(Math.abs(n/a)),"min"]:24*r>n?[Math.round(Math.abs(n/r)),"hr"]:7*i>n?[Math.round(Math.abs(n/i)),"day"]:52*c>n?[Math.round(Math.abs(n/c)),"week"]:10*u>n?[Math.round(Math.abs(n/u)),"year"]:100*l>n?[Math.round(Math.abs(n/l)),"decade"]:["","a long time"],s[1]+=0===s[0]||s[0]>1?"s":"",s=s.join(" "),o===!0?s:t>=e?s+" ago":"in "+s}}}),angular.module("clientHomeApp").controller("HotController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams","HotService",function(e,t,o,n,s,a,r,i,c,u,l,g,d,p,m,f){function h(){f.getHotThisWeekFromServer().success(function(e){r.hotThisWeek=f.updateHotThisWeek(e.hotThisWeek),w()}).error(function(e){r.responseStatusHandler(e)})}function w(){r.hotThisWeek.forEach(function(e){e.theTimeAgo=t("timeago")(e.createdAt),e.postDate=moment(e.createdAt).format("ddd, MMM D, H:mm")})}r.hotThisWeek=f.getHotThisWeek(),h(),n(w,12e4,0,!0),w(),i.$on("reconnect",function(){h()}),o.info("PostController booted successfully")}]),angular.module("clientHomeApp").controller("MainController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$document","$state","$stateParams","logoutService","cfpLoadingBar",function(e,t,o,n,s,a,r,i,c,u,l,g,d,p,m,f,h,w,v){function P(){l.getUserData().success(function(e){r.userData=g.userData(e.userData),r.clientIsRegistered="yes"==r.userData.isRegistered?!0:!1,"yes"==r.userData.isRegistered&&c.emit("joinRoom",{room:e.userData.uniqueCuid}),r.responseStatusHandler(e)}).error(function(e){r.responseStatusHandler(e)})}r.defaultDocumentTitle=function(){document.title="Negus Math - College Level Advanced Mathematics for Kenya Students"},r.changeDocumentTitle=function(e){e&&(document.title=e)},r.showDisqus=-1!==a.host().search("negusmath")?!0:!1,i.$on("$stateChangeSuccess",function(e,t,o,n,s){r.currentState=t.name});var S=[];i.$on("$routeChangeSuccess",function(){S.push(a.$$path)}),i.back=function(){var e=S.length>1?S.splice(-2)[0]:"/";a.path(e)},r.calcObjectLength=function(e){var t=0;for(var o in e)e.hasOwnProperty(o)&&t++;return t};var b=0;r.goToTop=function(){var e=angular.element(document.getElementById("top"));m.scrollToElement(e,80,b)},r.goToUniversalBanner=function(){var e=angular.element(document.getElementById("universalBanner"));m.scrollToElement(e,80,b)},r.makeVideoIframesResponsive=function(e){var t=$("<div>"+e+"</div>"),o=$("img.ta-insert-video",t);if(o.length>0){var n=o.addClass("embed-responsive-item").wrap("<div class='embed-responsive embed-responsive-16by9'></div>");t.find("img").replaceWith(n)}return t.html()},r.universalDisable=!1,r.showBanner=!1,r.bannerClass="",r.bannerMessage="",r.showRegistrationBanner=!1,r.registrationBannerClass="",r.registrationBannerMessage="",r.showNewPostBanner=!1,r.newPostBannerClass="",r.newPostBannerMessage="",r.clearBanners=function(){r.showBanner=!1,r.showRegistrationBanner=!1,r.showNewPostBanner=!1},i.$on("$stateChangeSuccess",function(e,t,o,n,s){r.clearBanners()}),r.universalDisableTrue=function(){r.universalDisable=!0},r.universalDisableFalse=function(){r.universalDisable=!1},r.responseStatusHandler=function(e){e&&(e.redirect&&e.redirect&&(s.location.href=e.redirectPage),e.disable&&e.disable&&r.universalDisableTrue(),e.notify&&e.type&&e.msg&&r.showToast(e.type,e.msg),e.banner&&e.bannerClass&&e.msg&&(r.showBanner=!0,r.bannerClass=e.bannerClass,r.bannerMessage=e.msg),e.newPostBanner&&e.bannerClass&&e.msg&&(r.showNewPostBanner=!0,r.newPostBannerClass=e.bannerClass,r.newPostBannerMessage=e.msg),e.registrationBanner&&e.bannerClass&&e.msg&&(r.showRegistrationBanner=!0,r.registrationBannerClass=e.bannerClass,r.registrationBannerMessage=e.msg),e.reason&&o.warn(e.reason))},i.$on("responseStatusHandler",function(e,t){r.responseStatusHandler(t)}),r.isLoading=!1,r.isLoadingPercentage=0,r.changeIsLoadingPercentage=function(e){r.isLoadingPercentage=e},r.showHideLoadingBanner=function(e){r.showHideLoadingBanner=function(e){e?($("#loading-splash-card").removeClass("hidden"),$(".hideMobileLoading").addClass("hidden-xs hidden-sm")):($("#loading-splash-card").addClass("hidden"),$(".hideMobileLoading").removeClass("hidden-xs hidden-sm"))}},i.$on("cfpLoadingBar:loading",function(e,t){r.isLoadingPercentage=100*v.status()}),i.$on("cfpLoadingBar:loaded",function(e,t){r.isLoadingPercentage=100*v.status()}),i.$on("cfpLoadingBar:completed",function(e,t){r.isLoadingPercentage=100*v.status()}),r.isLoadingTrue=function(){r.isLoading=!0},r.isLoadingFalse=function(){r.isLoading=!1},i.$on("isLoadingTrue",function(){r.isLoading=!0}),i.$on("isLoadingFalse",function(){r.isLoading=!1}),r.showToast=function(e,t){switch(e){case"success":toastr.clear(),toastr.success(t);break;case"warning":toastr.clear(),toastr.warning(t,"Warning",{closeButton:!0,tapToDismiss:!0});break;case"error":toastr.clear(),toastr.error(t,"Error",{closeButton:!0,tapToDismiss:!0,timeOut:!1});break;default:toastr.clear()}},i.$on("showToast",function(e,t){var o=t.toastType,n=t.text;r.showToast(o,n)}),r.currentTime="",r.currentTime=moment().format("ddd, MMM D, H:mm");var y=function(){r.currentTime=moment().format("ddd, MMM D, H:mm")};n(y,2e4,0,!0),c.on("joined",function(){console.log("JOIN SUCCESS")}),P(),r.goToLandingPage=function(){s.location.href="index"},r.logoutClient=function(){w.logoutClient().success(function(e){r.responseStatusHandler(e)}).error(function(e){r.responseStatusHandler(e)})},i.$on("reconnect",function(){}),o.info("MainController booted successfully")}]),angular.module("clientHomeApp").controller("PostsController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams",function(e,t,o,n,s,a,r,i,c,u,l,g,d,p,m){function f(){r.posts.forEach(function(e){e.postSummary=r.makeVideoIframesResponsive(e.postSummary)})}function h(){r.showHideLoadingBanner(!0),r.suggestedPosts=[],p.getSuggestedPostsFromServer().success(function(e){function t(){r.suggestedPosts.forEach(function(e){e.postSummary=r.makeVideoIframesResponsive(e.postSummary)})}e.postsArray.length>0?(r.showSuggestedPostsOnly(),r.suggestedPosts=e.postsArray,v(),t()):(r.suggestedPosts=[],r.showSuggestedPosts=!1,r.goToUniversalBanner())}).error(function(e){r.goToUniversalBanner(),r.showHideLoadingBanner(!1),r.suggestedPosts=[],r.showSuggestedPosts=!1,r.responseStatusHandler(e)})}function w(){r.showHideLoadingBanner(!0),p.getPostsFromServer(m.pageNumber).success(function(e){if(0==e.postsArray.length){r.posts=[];var t={banner:!0,bannerClass:"alert alert-dismissible alert-success",msg:"No more posts to show"};r.responseStatusHandler(t),r.showPosts=!1,h(),r.goToUniversalBanner()}else r.posts=p.updatePosts(e.postsArray),r.showThePostsOnly(),v(),e.postCount&&(r.postsCount=e.postsCount),f()}).error(function(e){r.responseStatusHandler(e),r.posts=[],r.showPosts=!1,h()})}function v(){r.posts.forEach(function(e){e.theTimeAgo=t("timeago")(e.createdAt),e.postDate=moment(e.createdAt).format("ddd, MMM D, H:mm")})}r.defaultDocumentTitle(),r.posts=p.getCurrentPosts(),r.postsCount=p.getCurrentPostsCount(),r.suggestedPosts=[],r.showPosts=!1,r.showSuggestedPosts=!1,r.showThePostsOnly=function(){r.showHideLoadingBanner(!1),r.showPosts=!0,r.showSuggestedPosts=!1},r.showSuggestedPostsOnly=function(){r.showHideLoadingBanner(!1),r.showPosts=!1,r.showSuggestedPosts=!0},w(),r.checkIfPostsIsEmpty=function(){return 0==r.posts.length},n(v,12e4,0,!0),v(),i.$on("newPost",function(e,t){1==m.pageNumber&&(r.posts.unshift(t.post),v(),f()),t.postCount&&(r.postCount=t.postCount)}),i.$on("reconnect",function(){w()}),o.info("PostController booted successfully")}]).controller("FullPostController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams",function(e,t,o,n,s,a,r,i,c,u,l,g,d,p,m){function f(){r.showHideLoadingBanner(!0),r.suggestedPosts=[],p.getSuggestedPostsFromServer().success(function(e){function t(){r.suggestedPosts.forEach(function(e){e.postSummary=r.makeVideoIframesResponsive(e.postSummary)})}e.postsArray.length>0?(r.showSuggestedPostsOnly(),r.suggestedPosts=e.postsArray,w(),t()):(r.suggestedPosts=[],r.showSuggestedPosts=!1,r.goToUniversalBanner())}).error(function(e){r.goToUniversalBanner(),r.showHideLoadingBanner(!1),r.suggestedPosts=[],r.showSuggestedPosts=!1,r.responseStatusHandler(e)})}function h(){r.showHideLoadingBanner(!0),p.getPostFromServer(r.postIndex).success(function(e){function t(){r.post.postContent=r.makeVideoIframesResponsive(r.post.postContent)}r.post=e.thePost,r.responseStatusHandler(e),0!=r.calcObjectLength(r.post)?(r.changeDocumentTitle(r.post.postHeading),r.showThePostOnly(),w(),v(),t(),r.showDisqus&&(r.postIsLoaded=!0)):(r.post={},r.showPost=!1,f(),r.goToUniversalBanner())}).error(function(e){r.responseStatusHandler(e),r.post={},r.showPost=!1,f()})}function w(){r.post&&(r.post.theTimeAgo=t("timeago")(r.post.createdAt),r.post.postDate=moment(r.post.createdAt).format("ddd, MMM D, H:mm")),r.suggestedPosts&&r.suggestedPosts.forEach(function(e){e.theTimeAgo=t("timeago")(e.createdAt),e.postDate=moment(e.createdAt).format("ddd, MMM D, H:mm")})}function v(){r.post.postUrl="http://www.negusmath.com/#!/post/"+r.post.postIndex}r.postIndex=m.postIndex,r.post={},r.suggestedPosts=[],r.showPost=!1,r.showSuggestedPosts=!1,r.showThePostOnly=function(){r.showHideLoadingBanner(!1),r.showPost=!0,r.showSuggestedPosts=!1},r.showSuggestedPostsOnly=function(){r.showHideLoadingBanner(!1),r.showPost=!1,r.showSuggestedPosts=!0},r.postIsLoaded=!1,h(),n(w,12e4,0,!0),i.$on("postUpdate",function(e,t){r.post=t.post,w()}),i.$on("reconnect",function(){r.editingMode||h()}),o.info("FullPostController booted successfully")}]),angular.module("clientHomeApp").factory("globals",["$q","$window","$rootScope","socketService",function(e,t,o,n){var s={};return{userData:function(e){return e?s=e:s}}}]),angular.module("clientHomeApp").factory("HotService",["$log","$http","$window","$rootScope","socket","socketService","globals",function(e,t,o,n,s,a,r){var i=[];return s.on("hotThisWeekPosts",function(e){n.$broadcast("hotThisWeekPosts",e)}),{getHotThisWeek:function(){return i},getHotThisWeekFromServer:function(){return t.post("/api/getHotThisWeek",{})},updateHotThisWeek:function(e){return i=e,e}}}]),angular.module("clientHomeApp").factory("mainService",["$log","$window","$rootScope","socket","socketService","globals",function(e,t,o,n,s,a){return n.on("reconnect",function(){e.info("'reconnect sequence' triggered"),o.$broadcast("reconnect")}),{done:function(){return 1}}}]),angular.module("clientHomeApp").factory("PostService",["$log","$http","$window","$rootScope","socket","socketService","globals",function(e,t,o,n,s,a,r,i){var c=[],u=0;return s.on("newPost",function(e){n.$broadcast("newPost",e)}),s.on("postUpdate",function(e){n.$broadcast("postUpdate",e)}),{getCurrentPosts:function(){return c},getCurrentPostsCount:function(){return u},getPostsFromServer:function(e){return t.post("/api/getPosts",{page:e})},getSuggestedPostsFromServer:function(){return t.post("/api/getSuggestedPosts",{})},updatePosts:function(e){return c=e,e},getPostFromServer:function(e){return t.post("/api/getPost",{postIndex:e})}}}]),angular.module("clientHomeApp").factory("socket",["$log","$location","$rootScope",function(e,t,o){var n;n=t.port()?t.host()+":"+t.port():t.host();var s=io.connect(n);return{on:function(e,t){s.on(e,function(){var e=arguments;o.$apply(function(){t.apply(s,e)})})},emit:function(e,t,n){s.emit(e,t,function(){var e=arguments;o.$apply(function(){n&&n.apply(s,e)})})},removeAllListeners:function(e,t){s.removeAllListeners(e,function(){var e=arguments;o.$apply(function(){t.apply(s,e)})})}}}]).factory("socketService",["$log","$http","$rootScope",function(e,t,o){return{getUserData:function(){return t.get("/api/getUserData")},sendContactUs:function(e){return t.post("/contactUs",e)}}}]).factory("logoutService",["$http",function(e){return{logoutClient:function(){return e.post("/api/logoutClient")}}}]);
//# sourceMappingURL=concatenated.min.js.map