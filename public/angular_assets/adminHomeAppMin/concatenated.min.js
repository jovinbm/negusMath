angular.module("adminHomeApp",["ui.bootstrap","angular-loading-bar","angulartics","angulartics.google.analytics","angularMoment","ui.router","duScroll","ngFx","ngAnimate","textAngular","ngSanitize","angularUtils.directives.dirDisqus"]).run(["$templateCache","$http",function(t,e){e.get("views/admin/partials/views/post_stream.html",{cache:t}),e.get("views/admin/partials/views/full_post.html",{cache:t})}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,o){e.otherwise("/home/1"),t.state("home",{url:"/home/:pageNumber",templateUrl:"views/admin/partials/views/post_stream.html"}).state("post",{url:"/post/:postIndex",templateUrl:"views/admin/partials/views/full_post.html"}).state("otherwise",{url:"/home/1"}),o.html5Mode(!1).hashPrefix("!")}]),angular.module("adminHomeApp").filter("timeago",function(){return function(t,e,o){if(!t)return"never";if(e||(e=Date.now()),angular.isDate(t)?t=t.getTime():"string"==typeof t&&(t=new Date(t).getTime()),angular.isDate(e)?e=e.getTime():"string"==typeof e&&(e=new Date(e).getTime()),"number"==typeof t&&"number"==typeof e){var n=Math.abs((e-t)/1e3),s=[],r=60,a=3600,i=86400,c=604800,u=31556926,l=315569260;return s=r>=n?["",o?"now":"less than a minute"]:60*r>n?[Math.round(Math.abs(n/r)),"min"]:24*a>n?[Math.round(Math.abs(n/a)),"hr"]:7*i>n?[Math.round(Math.abs(n/i)),"day"]:52*c>n?[Math.round(Math.abs(n/c)),"week"]:10*u>n?[Math.round(Math.abs(n/u)),"year"]:100*l>n?[Math.round(Math.abs(n/l)),"decade"]:["","a long time"],s[1]+=0===s[0]||s[0]>1?"s":"",s=s.join(" "),o===!0?s:e>=t?s+" ago":"in "+s}}}),angular.module("adminHomeApp").controller("HotController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams","HotService",function(t,e,o,n,s,r,a,i,c,u,l,p,d,m,g,f){function h(){f.getHotThisWeekFromServer().success(function(t){a.hotThisWeek=f.updateHotThisWeek(t.hotThisWeek),$()}).error(function(t){a.responseStatusHandler(t)})}function $(){a.hotThisWeek.forEach(function(t){t.theTimeAgo=e("timeago")(t.createdAt),t.postDate=moment(t.createdAt).format("ddd, MMM D, H:mm")})}a.hotThisWeek=f.getHotThisWeek(),h(),n($,12e4,0,!0),$(),i.$on("reconnect",function(){h()}),o.info("PostController booted successfully")}]),angular.module("adminHomeApp").controller("MainController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","logoutService","PostService","$document","$state","$stateParams",function(t,e,o,n,s,r,a,i,c,u,l,p,d,m,g,f,h,$){i.$on("$stateChangeSuccess",function(t,e,o,n,s){a.currentState=e.name});var w=[];i.$on("$routeChangeSuccess",function(){w.push(r.$$path)}),i.back=function(){var t=w.length>1?w.splice(-2)[0]:"/";r.path(t)},a.calcObjectLength=function(t){var e=0;for(var o in t)t.hasOwnProperty(o)&&e++;return e};var v=0;a.goToTop=function(){var t=angular.element(document.getElementById("top"));f.scrollToElement(t,80,v)},a.goToUniversalBanner=function(){var t=angular.element(document.getElementById("universalBanner"));f.scrollToElement(t,80,v)},a.clientIsRegistered=!1,a.universalDisable=!1,a.showBanner=!1,a.bannerClass="",a.bannerMessage="",a.showRegistrationBanner=!1,a.registrationBannerClass="",a.registrationBannerMessage="",a.showNewPostBanner=!1,a.newPostBannerClass="",a.newPostBannerMessage="",a.clearBanners=function(){a.showBanner=!1,a.showRegistrationBanner=!1,a.showNewPostBanner=!1},i.$on("$stateChangeSuccess",function(t,e,o,n,s){a.clearBanners()}),a.universalDisableTrue=function(){a.universalDisable=!0},a.universalDisableFalse=function(){a.universalDisable=!1},a.responseStatusHandler=function(t){t&&(t.redirect&&t.redirect&&(s.location.href=t.redirectPage),t.disable&&t.disable&&a.universalDisableTrue(),t.notify&&t.type&&t.msg&&a.showToast(t.type,t.msg),t.banner&&t.bannerClass&&t.msg&&(a.showBanner=!0,a.bannerClass=t.bannerClass,a.bannerMessage=t.msg),t.newPostBanner&&t.bannerClass&&t.msg&&(a.showNewPostBanner=!0,a.newPostBannerClass=t.bannerClass,a.newPostBannerMessage=t.msg),t.registrationBanner&&t.bannerClass&&t.msg&&(a.showRegistrationBanner=!0,a.registrationBannerClass=t.bannerClass,a.registrationBannerMessage=t.msg),t.reason&&o.warn(t.reason))},i.$on("responseStatusHandler",function(t,e){a.responseStatusHandler(e)}),a.isLoading=!1,a.isLoadingTrue=function(){a.isLoading=!0},a.isLoadingFalse=function(){a.isLoading=!1},i.$on("isLoadingTrue",function(){a.isLoading=!0}),i.$on("isLoadingFalse",function(){a.isLoading=!1}),a.showToast=function(t,e){switch(t){case"success":toastr.clear(),toastr.success(e);break;case"warning":toastr.clear(),toastr.warning(e,"Warning",{closeButton:!0,tapToDismiss:!0});break;case"error":toastr.clear(),toastr.error(e,"Error",{closeButton:!0,tapToDismiss:!0,timeOut:!1});break;default:toastr.clear()}},i.$on("showToast",function(t,e){var o=e.toastType,n=e.text;a.showToast(o,n)}),a.currentTime="",a.currentTime=moment().format("ddd, MMM D, H:mm");var P=function(){a.currentTime=moment().format("ddd, MMM D, H:mm")};n(P,2e4,0,!0),a.newPost=!1,a.showNewPost=function(){a.newPost=!0},a.hideNewPost=function(){a.newPost=!1},l.getUserData().success(function(t){a.userData=p.userData(t.userData),"yes"==a.userData.isRegistered&&(a.clientIsRegistered=!0),c.emit("joinRoom",{room:t.userData.uniqueCuid}),a.responseStatusHandler(t)}).error(function(t){a.responseStatusHandler(t)}),c.on("joined",function(){console.log("JOIN SUCCESS")}),a.newPostModel={postHeading:"",postContent:"",postSummary:""},a.submitNewPost=function(){if(0==a.newPostModel.postContent.length)a.showToast("warning","Please add some content to the post first");else{var t={postHeading:a.newPostModel.postHeading,postContent:a.newPostModel.postContent,postSummary:a.newPostModel.postSummary};g.submitNewPost(t).success(function(t){a.hideNewPost(),a.responseStatusHandler(t),a.newPostModel.postHeading="",a.newPostModel.postContent="",a.newPostModel.postSummary=""}).error(function(t){a.responseStatusHandler(t)})}},a.logoutClient=function(){m.logoutClient().success(function(t){a.responseStatusHandler(t)}).error(function(t){a.responseStatusHandler(t)})},i.$on("reconnect",function(){}),o.info("MainController booted successfully")}]),angular.module("adminHomeApp").controller("PostsController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams",function(t,e,o,n,s,r,a,i,c,u,l,p,d,m,g){function f(){m.getPostsFromServer(g.pageNumber).success(function(t){if(a.posts=m.updatePosts(t.postsArray),h(),a.postsCount=t.postsCount,0==a.posts.length){var e={banner:!0,bannerClass:"alert alert-dismissible alert-success",msg:"No more posts to show"};a.responseStatusHandler(e),a.goToUniversalBanner()}}).error(function(t){a.responseStatusHandler(t)})}function h(){a.posts.forEach(function(t){t.theTimeAgo=e("timeago")(t.createdAt),t.postDate=moment(t.createdAt).format("ddd, MMM D, H:mm")})}a.posts=m.getCurrentPosts(),a.postsCount=m.getCurrentPostsCount(),f(),a.checkIfPostsIsEmpty=function(){return 0==a.posts.length},n(h,12e4,0,!0),h(),i.$on("newPost",function(t,e){1==g.pageNumber&&(a.posts.unshift(e.post),h()),a.postCount=e.postCount}),i.$on("reconnect",function(){f()}),o.info("PostController booted successfully")}]).controller("FullPostController",["$q","$filter","$log","$interval","$window","$location","$scope","$rootScope","socket","mainService","socketService","globals","$modal","PostService","$stateParams",function(t,e,o,n,s,r,a,i,c,u,l,p,d,m,g){function f(){m.getPostFromServer(a.postIndex).success(function(t){a.post=t.thePost,a.responseStatusHandler(t),0!=a.calcObjectLength(a.post)?(h(),$(),a.postIsLoaded=!0):a.goToUniversalBanner()}).error(function(t){a.responseStatusHandler(t)})}function h(){a.post.theTimeAgo=e("timeago")(a.post.createdAt),a.post.postDate=moment(a.post.createdAt).format("ddd, MMM D, H:mm")}function $(){a.post.postUrl="http://"+r.host()+"/adminHome.html#!/post/"+a.post.postIndex}a.postIndex=g.postIndex,a.post={},a.postIsLoaded=!1,a.checkIfPostIsEmpty=function(){return 0==a.calcObjectLength(a.post)},f(),n(h,12e4,0,!0),a.editingMode=!1,a.postBackup=a.post,a.goIntoPostEditingMode=function(){a.postBackup=a.post,a.editingMode=!0},a.goIntoFullPostViewMode=function(){a.editingMode=!1},a.submitPostUpdate=function(){0==a.post.postContent.length?a.showToast("warning","Please add some content to the post first"):m.submitPostUpdate(a.post).success(function(t){a.goIntoFullPostViewMode(),a.responseStatusHandler(t)}).error(function(t){a.responseStatusHandler(t)})},a.cancelPostUpdate=function(){a.post=a.postBackup,a.goIntoFullPostViewMode(),a.showToast("success","Update cancelled")},i.$on("postUpdate",function(t,e){a.post=e.post,h()}),i.$on("reconnect",function(){a.editingMode||f()}),o.info("FullPostController booted successfully")}]),angular.module("adminHomeApp").factory("globals",["$q","$window","$rootScope","socketService",function(t,e,o,n){var s={};return{userData:function(t){return t?s=t:s}}}]),angular.module("adminHomeApp").factory("HotService",["$log","$http","$window","$rootScope","socket","socketService","globals",function(t,e,o,n,s,r,a){var i=[];return s.on("hotThisWeekPosts",function(t){n.$broadcast("hotThisWeekPosts",t)}),{getHotThisWeek:function(){return i},getHotThisWeekFromServer:function(){return e.post("/api/getHotThisWeek",{})},updateHotThisWeek:function(t){return i=t,t}}}]),angular.module("adminHomeApp").factory("mainService",["$log","$window","$rootScope","socket","socketService","globals",function(t,e,o,n,s,r){return n.on("reconnect",function(){t.info("'reconnect sequence' triggered"),o.$broadcast("reconnect")}),{done:function(){return 1}}}]),angular.module("adminHomeApp").factory("PostService",["$log","$http","$window","$rootScope","socket","socketService","globals",function(t,e,o,n,s,r,a,i){var c=[],u=0;return s.on("newPost",function(t){n.$broadcast("newPost",t)}),s.on("postUpdate",function(t){n.$broadcast("postUpdate",t)}),{getCurrentPosts:function(){return c},getCurrentPostsCount:function(){return u},getPostsFromServer:function(t){return e.post("/api/getPosts",{page:t})},updatePosts:function(t){return c=t,t},getPostFromServer:function(t){return e.post("/api/getPost",{postIndex:t})},submitNewPost:function(t){return e.post("/api/newPost",{newPost:t})},submitPostUpdate:function(t){return e.post("/api/updatePost",{postUpdate:t})}}}]),angular.module("adminHomeApp").factory("socket",["$log","$location","$rootScope",function(t,e,o){var n;n=e.port()?e.host()+":"+e.port():e.host();var s=io.connect(n);return{on:function(t,e){s.on(t,function(){var t=arguments;o.$apply(function(){e.apply(s,t)})})},emit:function(t,e,n){s.emit(t,e,function(){var t=arguments;o.$apply(function(){n&&n.apply(s,t)})})},removeAllListeners:function(t,e){s.removeAllListeners(t,function(){var t=arguments;o.$apply(function(){e.apply(s,t)})})}}}]).factory("socketService",["$log","$http","$rootScope",function(t,e,o){return{getUserData:function(){return e.get("/api/getUserData")},sendContactUs:function(t){return e.post("/contactUs",t)}}}]).factory("logoutService",["$http",function(t){return{logoutClient:function(){return t.post("/api/logoutClient")}}}]);
//# sourceMappingURL=concatenated.min.js.map